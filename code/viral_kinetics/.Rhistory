onset_times <- simulate_symptom_onsets(infection_times)
## Simulate viral loads for the sample population
#simulated_data <- simulate_viral_loads(infection_times, onset_times, times, pars)
#viral_loads <- simulated_data$viral_loads
viral_loads <- read_csv("seir_viral_loads.csv")
head(viral_loads)
colnames(viral_loads)
inf_times <- apply(viral_loads, 1, function(x) which(x > 0)[1])
hist(inf_times)
inf_times
sapply(test_times, function(x){
tmp <- x - inf_times
tmp <- tmp[tmp > 0]
})
test_times <- seq(0,350,by=25)
sapply(test_times, function(x){
tmp <- x - inf_times
tmp <- tmp[tmp > 0]
})
wow <- sapply(test_times, function(x){
tmp <- x - inf_times
tmp <- tmp[tmp > 0]
tmp[!is.na(tmp)]
})
head(wow)
lapply(wow, mean)
c(lapply(wow, mean))
unlist(lapply(wow, mean))
greb <- unlist(lapply(wow, mean))
plot(greb~test_times)
lapply(wow, function(x) quantile(x,c(0.025,0.5,0.975)))
do.call("rbind",res)
res <- lapply(wow, function(x) quantile(x,c(0.025,0.5,0.975)))
do.call("rbind",res)
test_times <- seq(1,351,by=25)
wow <- sapply(test_times, function(x){
tmp <- x - inf_times
tmp <- tmp[tmp > 0]
tmp[!is.na(tmp)]
})
res <- lapply(wow, function(x) quantile(x,c(0.025,0.5,0.975)))
do.call("rbind",res)
test_times <- seq(25,350,by=25)
wow <- sapply(test_times, function(x){
tmp <- x - inf_times
tmp <- tmp[tmp > 0]
tmp[!is.na(tmp)]
})
res <- lapply(wow, function(x) quantile(x,c(0.025,0.5,0.975)))
res <- do.call("rbind",res)
test_times <- seq(10,350,by=10)
wow <- sapply(test_times, function(x){
tmp <- x - inf_times
tmp <- tmp[tmp > 0]
tmp[!is.na(tmp)]
})
res <- lapply(wow, function(x) quantile(x,c(0.025,0.5,0.975)))
res <- do.call("rbind",res)
res
colnames(res) <- c("lower","median","upper")
res$time <- test_times
res <- lapply(wow, function(x) quantile(x,c(0.025,0.5,0.975)))
res <- do.call("rbind",res)
colnames(res) <- c("lower","median","upper")
res <- as.data.frame(res)
res$time <- test_times
ggplot(res) + geom_ribbon(aes(ymin=lower,ymax=upper,x=))
ggplot(res) + geom_ribbon(aes(ymin=lower,ymax=upper,x=time))
pAb <- ggplot(res) + geom_ribbon(aes(ymin=lower,ymax=upper,x=time),alpha=0.5) + geom_line(aes(x=time,y=median))
pA/pAb
pAb <- ggplot(res) + geom_ribbon(aes(ymin=lower,ymax=upper,x=time),alpha=0.5) +
geom_line(aes(x=time,y=median)) + theme_pubr()
pAb <- ggplot(res) + geom_ribbon(aes(ymin=lower,ymax=upper,x=time),alpha=0.5) +
geom_line(aes(x=time,y=median)) + theme_pubr() +
ylab("Time since infection") +
xlab("Date")
pA/pAb
pAb <- ggplot(res) + geom_ribbon(aes(ymin=lower,ymax=upper,x=time),alpha=0.5) +
geom_line(aes(x=time,y=median)) + theme_bw() +
ylab("Time since infection") +
xlab("Date")
pA/pAb
test_times <- seq(1,350,by=1)
wow <- sapply(test_times, function(x){
tmp <- x - inf_times
tmp <- tmp[tmp > 0]
tmp[!is.na(tmp)]
})
res <- lapply(wow, function(x) quantile(x,c(0.025,0.5,0.975)))
res <- do.call("rbind",res)
colnames(res) <- c("lower","median","upper")
res <- as.data.frame(res)
res$time <- test_times
pAb <- ggplot(res) + geom_ribbon(aes(ymin=lower,ymax=upper,x=time),alpha=0.5) +
geom_line(aes(x=time,y=median)) + theme_bw() +
ylab("Time since infection") +
xlab("Date")
pA/pAb
waning_dat <- read_csv("data/waning.csv")
head(waning_dat)
waning_dat %>% group_by(time) %>% summarise(sum(positive)/n())
greb <- waning_dat %>% group_by(time) %>% summarise(sum(positive)/n())
plot(greb)
greb <- waning_dat %>% group_by(time) %>% summarise(prop_positive=sum(positive)/n())
greb <- waning_dat %>% group_by(time) %>% summarise(prop_positive=sum(positive)/n())
ggplot(greb) + geom_line(aes(x=time,y=prop_positive))
greb <- waning_dat %>% group_by(time) %>% summarise(prop_positive=sum(positive)/n(),
n=n())
greb
ggplot(greb) + geom_line(aes(x=time,y=prop_positive))
prop.test(0.5,100)
prop.test(0.5,100)
prop.test(0.5,100)[1]
prop.test(0.5,100)[2]
res <- prop.test(0.5,100)
res$conf.int[1]
res$conf.int[2]
greb <- waning_dat %>% group_by(time) %>% summarise(prop_positive=sum(positive)/n(),
n=n(),
confint_low=prop.test(sum(positive), n)$conf.int[1],
confint_high=prop.test(sum(positive), n)$conf.int[2])
warnings()
greb <- waning_dat %>% group_by(time) %>% summarise(prop_positive=sum(positive)/n(),
n=n(),
confint_low=prop.test(sum(positive), n())$conf.int[1],
confint_high=prop.test(sum(positive), n())$conf.int[2])
greb <- waning_dat %>% group_by(time) %>% summarise(prop_positive=sum(positive)/n(),
n=n())
greb
waning_dat <- read_csv("data/waning.csv")
greb <- waning_dat %>% group_by(time) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
ggplot(greb) + geom_line(aes(x=time,y=prop_positive))
greb
greb <- waning_dat %>% group_by(time) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n) %>%
mutate(lower_confint=prop.test(n_positive,n)$conf.int[[1]])
greb
apply(greb,1, function(x) prop.test(x[2],x[3]))
warnings()
greb[1,]
greb[1,"n_positive"]
greb[1,2]
greb[1,3]
prop.test(1,1)
apply(greb,1, function(x) prop.test(x[2],x[3]))
greb <- waning_dat %>% group_by(time) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n,
lower_confint = prop.test(n_positive,n)$conf.int[1])
greb
View(greb)
lower_confint = ifelse(n > 1, prop.test(n_positive,n)$conf.int[1], 0)
mutate(lower_confint = ifelse(n > 1, prop.test(n_positive,n)$conf.int[1], 0)
greb <- waning_dat %>% group_by(time) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n) %>%
mutate(lower_confint = ifelse(n > 1, prop.test(n_positive,n)$conf.int[1], 0))
greb <- waning_dat %>% group_by(time) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb
n_positive <- greb$n_positive[1]
n_positive
prop.test(n_positive,n)
for(i in 1:nrow(greb)){
n_positive <- greb$n_positive[i]
n <- greb$n[i]
prop.test(n_positive,n)
}
for(i in 1:nrow(greb)){
print(i)
n_positive <- greb$n_positive[i]
n <- greb$n[i]
prop.test(n_positive,n)
}
for(i in 1:nrow(greb)){
print(i)
n_positive <- greb$n_positive[i]
n <- greb$n[i]
print(n)
prop.test(n_positive,n)
}
for(i in 1:nrow(greb)){
print(i)
n_positive <- greb$n_positive[i]
n <- greb$n[i]
print(n_positive)
print(n)
prop.test(n_positive,n)
}
greb <- greb %>% drop_na()
for(i in 1:nrow(greb)){
print(i)
n_positive <- greb$n_positive[i]
n <- greb$n[i]
print(n_positive)
print(n)
prop.test(n_positive,n)
}
final <- matrix(nrow=nrow(greb),ncol=2)
for(i in 1:nrow(greb)){
n_positive <- greb$n_positive[i]
n <- greb$n[i]
res <- prop.test(n_positive,n)
final[i,1] <- res$conf.int[1]
final[i,2] <- res$conf.int[2]
}
final
greb <- cbind(greb, final)
head(Greb)
head(greb)
waning_dat <- read_csv("data/waning.csv")
greb <- waning_dat %>% group_by(time) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
final <- matrix(nrow=nrow(greb),ncol=2)
for(i in 1:nrow(greb)){
n_positive <- greb$n_positive[i]
n <- greb$n[i]
res <- prop.test(n_positive,n)
final[i,1] <- res$conf.int[1]
final[i,2] <- res$conf.int[2]
}
colnames(finak) <- c("lower","upper")
greb <- cbind(greb, final)
ggplot(greb) +
geom_ribbon(aes(x=time,ymin=lower,ymax=upper),col="blue",alpha=0.5) +
geom_line(aes(x=time,y=prop_positive))
colnames(final) <- c("lower","upper")
greb <- cbind(greb, final)
ggplot(greb) +
geom_ribbon(aes(x=time,ymin=lower,ymax=upper),col="blue",alpha=0.5) +
geom_line(aes(x=time,y=prop_positive))
ggplot(greb) +
geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_line(aes(x=time,y=prop_positive))
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_line(aes(x=time,y=prop_positive))
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_point(data=waning_dat, aes(x=time,y=positive)) +
geom_line(aes(x=time,y=prop_positive))
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_jitter(data=waning_dat, aes(x=time,y=positive)) +
geom_line(aes(x=time,y=prop_positive))
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_jitter(data=waning_dat, aes(x=time,y=positive),height=0.1,width=0.01) +
geom_line(aes(x=time,y=prop_positive))
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_jitter(data=waning_dat, aes(x=time,y=positive),height=0.01,width=0.01) +
geom_line(aes(x=time,y=prop_positive))
?glm
model <- glm(waning_dat, positive~time)
model <- glm(waning_dat, positive~time, family="bonimal")
model <- glm(waning_dat, positive~time, family="binomal")
model <- glm(waning_dat, positive~time, family="binomial")
model <- glm(data=waning_dat, positive~time, family="binomial")
model
plot(model)
predict(model)
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_jitter(data=waning_dat, aes(x=time,y=positive),height=0.01,width=0.01) +
geom_line(aes(x=time,y=prop_positive))
head(waning_dat)
ggplot(greb) +
geom_line(data=waning_dat,aes(x=time,y=positive,group=Patient))
waning_dat
ggplot(greb) +
geom_line(data=waning_dat,aes(x=time,y=positive,group=Patients))
ggplot(greb) +
geom_line(data=waning_dat,aes(x=time,y=positive,group=Patients,col=Patients))
ggplot(greb) +
geom_line(data=waning_dat,aes(x=time,y=positive)) + facet_wrap(~Patients)
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time))
waning_dat
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE))
ggplot() +
geom_line(data=waning_dat,aes(x=time1,y=positive)) + facet_wrap(~Patients)
ggplot() +
geom_line(data=waning_dat,aes(x=time1,y=positive,group=Patients))# + facet_wrap(~Patients)
waning_dat <- read_csv("data/waning.csv")
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE))
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
final <- matrix(nrow=nrow(greb),ncol=2)
for(i in 1:nrow(greb)){
n_positive <- greb$n_positive[i]
n <- greb$n[i]
res <- prop.test(n_positive,n)
final[i,1] <- res$conf.int[1]
final[i,2] <- res$conf.int[2]
}
colnames(final) <- c("lower","upper")
greb <- cbind(greb, final)
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_jitter(data=waning_dat, aes(x=time1,y=positive),height=0.01,width=0.01) +
geom_line(aes(x=time,y=prop_positive))
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE))
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
final <- matrix(nrow=nrow(greb),ncol=2)
for(i in 1:nrow(greb)){
n_positive <- greb$n_positive[i]
n <- greb$n[i]
res <- prop.test(n_positive,n)
final[i,1] <- res$conf.int[1]
final[i,2] <- res$conf.int[2]
}
colnames(final) <- c("lower","upper")
greb <- cbind(greb, final)
greb
ggplot() +
geom_line(data=waning_dat,aes(x=time1,y=positive,group=Patients)) + facet_wrap(~Patients)
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
final <- matrix(nrow=nrow(greb),ncol=2)
for(i in 1:nrow(greb)){
n_positive <- greb$n_positive[i]
n <- greb$n[i]
res <- prop.test(n_positive,n)
final[i,1] <- res$conf.int[1]
final[i,2] <- res$conf.int[2]
}
colnames(final) <- c("lower","upper")
greb <- cbind(greb, final)
ggplot(greb) +
#geom_ribbon(aes(x=time,ymin=lower,ymax=upper),fill="blue",alpha=0.5) +
geom_jitter(data=waning_dat, aes(x=time1,y=positive),height=0.01,width=0.01) +
geom_line(aes(x=time1,y=prop_positive))
greb
waning_dat
greb1 <- greb %>% select(Patients, positive, time1)
greb1 <- greb %>% ungroup() %>% select(Patients, positive, time1)
class(greb)
greb1 <- greb %>% as_tibble() %>% ungroup() %>% select(Patients, positive, time1)
waning_dat1 <- waning_dat %>% as_tibble() %>% ungroup() %>% select(Patients, positive, time1)
waning_dat
colnames(waning_dat)
waning_dat1 <- waning_dat %>% select(Patients, positive, time1)
waning_dat %>% select(Patients, positive, time1)
waning_dat %>% select(positive, time1)
waning_dat %>% select(waning_dat, positive, time1)
?select
library(tidyverse)
waning_dat %>% select(waning_dat, positive, time1)
waning_dat %>% select( positive, time1)
class(waning_dat)
waning_dat <- waning_dat %>% ungroup()
waning_dat
waning_dat <- waning_dat %>% ungroup() %>% select(Gender)
waning_dat <- waning_dat %>% ungroup() %>% select(1)
waning_dat <- waning_dat %>% ungroup()
waning_dat <- waning_dat %>% ungroup() pull(Patients)
waning_dat <- waning_dat %>% ungroup() %>% drop_na() %>% pull(Patients)
waning_dat
waning_dat <- waning_dat %>% ungroup() %>% drop_na() %>% selectPatients)
waning_dat <- waning_dat %>% ungroup() %>% drop_na() %>% select(Patients)
waning_dat <- read_csv("data/waning.csv")
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE))
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
waning_dat <- waning_dat %>% ungroup() %>% drop_na() %>% select(Patients)
waning_dat <- read_csv("data/waning.csv")
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE))
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
library(tidyverse)
waning_dat <- read_csv("data/waning.csv")
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE))
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
waning_dat <- waning_dat %>% ungroup() %>% drop_na() %>% select(Patients)
waning_dat1 <- waning_dat %>% select(Patients, positive, time1)
library(tidyverse)
waning_dat <- read_csv("data/waning.csv")
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE))
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
waning_dat1 <- waning_dat %>% select(Patients, positive, time1)
waning_dat1
?pivot_wider
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>%
pivot_wider(names_from=time1, values_from=positive)
waning_dat1
class(waning_dat$time1)
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>%
pivot_wider(names_from=time1, values_from=positive,values_fill=NA)
waning_dat
waning_dat %>% drop_na() %>% ungroup()
waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1)
waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% group_by(Patients) %>% filter(Patients=="Patient1")
waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% group_by(Patients) %>% filter(Patients=="Patient2")
waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% group_by(Patients) %>% filter(Patients=="Patient3")
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>%
pivot_wider(names_from=time1, values_from=positive,values_fill=NA)
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>%
pivot_wider(names_from=time1, values_from=positive)
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1)
waning_dat1
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive)
waning_dat1$time1 <- as.factor(waning_dat1$time1)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive)
unique(waning_dat1$positive)
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique()
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1$time1 <- as.factor(waning_dat1$time1)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive)
waning_dat
waning_dat <- read_csv("data/waning.csv")
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE)) %>% drop_na()
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique()
waning_dat1
waning_dat1 %>% gorup_by(Patients, time1) %>% summarise(n())
waning_dat1 %>% group_by(Patients, time1) %>% summarise(n())
waning_dat1 %>% group_by(Patients, time1) %>% summarise(wow=n()) %>% pull(wow) %>% unique
waning_dat1 %>% group_by(Patients, time1) %>% summarise(wow=n()) %>% filter(wow != 1)
waning_dat
waning_dat %>% filter(Patients == "Patient47")
(tidyverse)
waning_dat <- read_csv("data/waning.csv")
waning_dat <- waning_dat %>% group_by(Patients) %>% mutate(time1 = time - min(time,na.rm=TRUE)) %>% drop_na()
greb <- waning_dat %>% group_by(time1) %>% summarise(n_positive=sum(positive),
n=n(),
prop_positive=n_positive/n)
greb <- greb %>% drop_na()
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique()
waning_dat1 %>% group_by(Patients, time1) %>% summarise(wow=n()) %>% filter(wow != 1)
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1$time1 <- as.factor(waning_dat1$time1)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive,values_fill = list(seen=0))
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive,values_fill = list(seen=0))
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique() %>% arrange(Patients, time1)
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive,values_fill = list(seen=0))
waning_dat1
waning_dat1$time1
class(waning_dat1$time1)
max(waning_dat1$time1)
waning_dat1$time1 <- factor(waning_dat1$time1, levels=0:32)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive,values_fill = list(seen=0))
waning_dat1
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique() %>% arrange(time1,Patients1)
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1$time1 <- factor(waning_dat1$time1, levels=0:32)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive,values_fill = list(seen=0))
waning_dat1
waning_dat1$positive <- as.factor(waning_dat1$positive)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive,values_fill = list(seen=0))
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique() %>% arrange(time1,Patients1)
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1$time1 <- paste0("day",waning_dat1$time1)
waning_dat1
waning_dat1$time1 <- paste0("day",waning_dat1$time1)
waning_dat1$positive <- as.factor(waning_dat1$positive)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive,values_fill = list(seen=0))
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique() %>% arrange(time1,Patients1)
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1$time1 <- paste0("day",waning_dat1$time1)
waning_dat1$positive <- as.factor(waning_dat1$positive)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive)
waning_dat1
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique() %>% arrange(time1,Patients1)
waning_dat1 <- waning_dat %>% drop_na() %>% ungroup() %>% select(Patients, positive, time1) %>% unique() %>% arrange(time1,Patients)
waning_dat1$Patients <- as.factor(waning_dat1$Patients)
waning_dat1$time1 <- paste0("day",waning_dat1$time1)
waning_dat1$positive <- as.factor(waning_dat1$positive)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive)
waning_dat1 %>%
pivot_wider(names_from=time1, values_from=positive) %>% View
