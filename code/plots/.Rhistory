legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.1) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1))) +
scale_linetype_discrete() +
scale_fill_manual(values=c("#AD002AFF")) +
guides(linetype=guide_legend(title=NULL),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.1) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("#AD002AFF")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.1) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("#grey80")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.1) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey80")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey80")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,3.5))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=8,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=8,units="in")
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.background = element_blank(),
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,3.5))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=8,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=8,units="in")
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,3))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=7,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=7,units="in")
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,3.5))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=7,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=7,units="in")
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
legend.spacing.x = unit(0.1, 'pt'),
plot.background = element_blank(),
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
legend.spacing.x = unit(0.25, 'pt'),
plot.background = element_blank(),
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
legend.spacing = unit(0.25, 'pt'),
plot.background = element_blank(),
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
legend.spacing.x = unit(0.5, 'pt'),
plot.background = element_blank(),
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.background = element_blank(),
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,3.5))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=7,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=7,units="in")
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,4))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=7,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=7,units="in")
fig3b_alt <- dat5 %>%
ggplot() +
geom_rect(data=inaccurate_levels, aes(fill="p < 1/N"), xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf, alpha=0.25) +
geom_line(aes(x=name,y=value,group=i),size=0.01,col="grey30") +
geom_line(data=dat_medians,aes(x=name,y=median_val,group=i,linetype="Median"),col="#925E9FFF",size=0.5) +
geom_point(aes(x=name,y=value,col=name),size=0.1) +
#geom_text(data=legend_label,aes(x=text,label=text2),y=-1,col="#AD002AFF",
#          size=1.5,angle=90) +
facet_grid(label~group,switch="x") +
scale_color_lancet(guide=guide_legend(title=NULL,#"Testing strategy",
override.aes = list(size=2,alpha=1),order=1)) +
scale_linetype_discrete() +
scale_fill_manual(values=c("grey70")) +
guides(linetype=guide_legend(title=NULL,order=2),fill=guide_legend(title=NULL,order=99)) +
theme_light() +
ylab("Prevalence per capita (log scale)") +
xlab("Prevalence in population (per capita)") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.text.y = element_text(size=6,color="white"),
strip.background.y = element_rect(fill="grey70",color="black"),
strip.text.x = element_text(size=6,color="black"),
strip.background.x = element_blank(),
axis.text.y=element_text(size=6),
axis.title.y=element_text(size=8),
axis.title.x=element_text(size=8),
legend.title=element_text(size=8),
legend.text=element_text(size=6),
legend.margin = margin(-5,-5,-5,-5),
legend.background = element_blank(),
legend.position="top",
plot.background = element_blank(),
plot.tag = element_text(size=10,face="bold")) +
scale_y_log10(limits=c(5e-6,1), breaks=c(0.00001,0.0001,0.001,0.01,0.1,1),
labels=c("<0.00001",sapply(c(0.0001,0.001,0.01,0.1,1), function(x) sprintf("%g",x)))) +
labs(tag="B")
fig3b_alt
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,3.5))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=8,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=8,units="in")
fig3_overall <- (fig3 | wrap_elements(full = fig3b_alt, clip = FALSE)) +plot_layout(widths=c(1,3))
ggsave("fig3_overall_alt.png",fig3_overall,height=4.5,width=8,units="in")
ggsave("fig3_overall_alt.pdf",fig3_overall,height=4.5,width=8,units="in")
